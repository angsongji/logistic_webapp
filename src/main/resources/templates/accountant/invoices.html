<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="fragments/header :: head"></head>
  <body class="bg-light">
    <nav th:replace="fragments/header :: navbar"></nav>

    <div id="page-content" class="container mt-4">
      <h3 class="mb-3">üßæ Qu·∫£n l√Ω h√≥a ƒë∆°n</h3>

      <table class="table table-hover">
        <thead>
          <tr class="table-primary text-center">
            <th>ID</th>
            <th>S·ªë h√≥a ƒë∆°n</th>
            <th>ƒê∆°n h√†ng</th>
            <th>T·ªïng ti·ªÅn</th>
            <th>Tr·∫°ng th√°i</th>
            <th>Thao t√°c</th>
          </tr>
        </thead>
        <tbody id="invoices-table"></tbody>
      </table>

      <script>
        async function loadInvoices() {
          const res = await fetch("/api/accountant/invoices", {
            credentials: "include",
          });
          if (!res.ok) {
            document.getElementById("invoices-table").innerHTML =
              '<tr><td colspan="6">Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu h√≥a ƒë∆°n</td></tr>';
            return;
          }
          const data = await res.json();
          const tbody = document.getElementById("invoices-table");
          tbody.innerHTML = data
            .map(
              (inv) =>
                `<tr>
                    <td>${inv.id}</td>
                    <td>${inv.invoiceNumber}</td>
                    <td>${inv.orderId || ""}</td>
                    <td>${inv.totalAmount || 0}</td>
                    <td>${inv.status}</td>
                    <td>
                        <button class='btn btn-primary btn-sm' onclick='view(${
                          inv.id
                        })'>Xem</button>
                    </td>
                </tr>`
            )
            .join("");
        }

        function view(id) {
          // simple navigation to invoice detail if exists
          window.location.href = `/web/accountant/invoices/${id}`;
        }

        loadInvoices();
      </script>
    </div>

    <footer th:replace="fragments/footer :: footer"></footer>
  </body>
</html>
